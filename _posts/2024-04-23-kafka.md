---
title: "Kafka Design Introduction"
date: 2024-04-27
---

## Introduction
High throughput
Large data backlogs
Low lantency
Partition
Fault Tolerance

## Design
### Persistence
### Efficiency
small I/O operations, excessive byte copying

Batching - Amortize the network roundtrip cost by grouping messages in network requests
Larger network packets, larger sequential disk operations, contigugous memory blocks, smooth bursts of messages

Sendfile - avoid byte copying; pagecache -> socket

Batch Compression - Producer compress a batch of messages -> broker validates the batch -> Broker persist the batch in comprepssion form -> Consumer get compressed batches -> Consumer decompress

### Producer
Load balancing - Any Kafka nodes can answer metadata about leader of topics; Client controls which partition to publish messages; Support semantic partitioning
Asynchronous send - Accumulate messages before sending batches out asychronously

### Consumer
where data is pushed to the broker from the producer and pulled from the broker by the consumer

**Pull based system**
Pros - 1. Consumer controls its own pace, no overwhelming 2. Allow aggresive batching of data sent to the consumer
Cons - 1. Busy waiting (long poll mitigates it)

**Consumer Position**
In Brokers
Cons - 1. Complicated with broker management because message/acknowledgement could be lost/unordered in network
In Clients
Pros - 1. Small position metadata for each consumer group

**Offline Data Load**
Scalable persistence in Kafka allows bulk-load data into an offline system for further analysis, like Hadoop or a relational data warehouse.

**Static membership**


